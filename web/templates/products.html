<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <script src="../static/js/pagination.js"></script>
  <script src="../static/js/popup.js"></script>
  <link rel="stylesheet" href="../static/css/general.css" />
  <link rel="stylesheet" href="../static/css/menu.css" />
  <link rel="icon" href="../static/images/favicon.png" type="image/x-icon" />

  {% if params["user"] == "manager" %}
    <title> Manager Menu | Técnico Shop</title>
  {% else %}
    <title> Client Order | Técnico Shop</title>
  {% endif %}

</head>

<body>
  <div class="nav-bar" style="background-color: #bcc5f9e3;">
    <a href="{{url_for('homepage')}}" class="right-side-nav">
      <img src="../static/images/favicon.png" class="logo">
      <p><strong>Técnico Shop</strong></p>
      {% if params["user"] == "manager" %}
        <p style="color: #596296;">Manager</p>
      {% else %}
        <p style="color: #596296;">Client</p>
      {% endif %}
    </a>
    <div>
      <a href="{{url_for('homepage')}}" class="nav-text">Logout</a>
    </div>
  </div>

  {% if params["user"] == "manager" %}
    <div class="menu">
      <a href="{{url_for('customers_list', user='manager')}}" class="menu-link">Customers</a>
      <a href="{{url_for('suppliers_list', user='manager')}}" class="menu-link">Suppliers</a>
      <a href="{{url_for('products_list', user='manager')}}" class="menu-link-selected">Products</a>
    </div>
  {% endif %}

  <div style="padding:2%">
    <div class="header">
      <h1>PRODUCTS IN DATABASE</h1>
      {% if params["user"] == "manager" %}
        <a href="{{url_for('product_register_get')}}"class="nav-text"><button class="action-button">+ NEW PRODUCT</button></a>
      {% else %}
        <a href="{{url_for('product_register_get')}}"class="nav-text"><button class="action-button">+ MAKE ORDER</button></a>
      {% endif %}
    </div>
    <hr class="menu-line">
    <div>
      {% if cursor %}
      <form id="limitForm">
        <div class="table-container">
            <table>
              <thead>
                <tr>
                  {% if params["user"] == "manager" %}
                    <th>SKU</th>
                  {% endif %}
                  <th>Name</th>
                  <th>Description</th>
                  <th>Price</th>
                  {% if params["user"] == "manager" %}
                    <th>EAN</th>
                    <th></th>
                  {% endif %}
                  <th></th>
                </tr>
              </thead>
              <tbody>
                {% for record in cursor %}
                <tr>
                  {% if params["user"] == "manager" %}
                    <td>
                      {{ record[0] }}
                    </td>
                  {% endif %}
                  <td>
                    <div id="curr-name">
                      <p style="font-size: 20px;">{{ record[1] }}</p>
                    </div>
                  </td>
                  <td>
                    <div id="curr-desc-{{ record[0] }}">
                      <p style="font-size: 20px;">{{ record[2] }}</p>
                    </div>
                  </td>
                  <td>
                    <div id="curr-price-{{ record[0] }}">
                      <p style="font-size: 20px;">{{ record[3] }}</p>
                    </div>
                  </td>
                  {% if params["user"] == "manager" %}
                    <td>{{ record[4] }}</td>
                    <td style="font-size: 20px;">
                      <p class="edit-text" id="edit-button-{{ record[0] }}" onclick="showPopUp(event, '{{ record[0] }}')">Edit</p>
                    </td>
                  {% endif %}
                  <td>
                    {% if params["user"] == "manager" %}
                      <a href="{{url_for('product_remove', product=record[0])}}" class="remove-text">
                        Remove
                      </a>
                    {% else %}
                      <p class="edit-text">{{params["user"]}}</p>
                    {% endif %}
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>

          <form id="offsetForm" action="/products" method="get">
            <div class="show-wrapper">
              <input type="hidden" id="offset" name="offset" value="{{offset}}">
              {% if offset != 0 %}
              <button type="button" onclick="decrementOffset()"><strong>&#9664;</strong></button>
              {% endif %}
              <button type="button" onclick="incrementOffset()"><strong>&#9654;</strong></button>
            </div>
          </form>

        </div>
      {% else %}
      <p>There are no products.</p>
      {% endif %}
    </div>
  </div>

  <!-- Popup form and background -->
  <div id="popupBackground" class="popup-background">
    <div class="popup-form">
      <h2 style="margin-bottom: 10px;">Edit Product</h2>
      <form action="{{url_for('product_edit', user=params['user'])}}" method="post" class="pop-form">
        <input type="hidden" id="popup-sku" name="popup-sku" value="">
        <div>
          <label for="popup-description">Description:</label><br>
          <textarea type="text" name="popup-description" id="popup-description" maxlength="255" style="min-height:120px;max-height:120px;max-width:450px;min-width:450px;font-size: 20px;padding:5px;"></textarea>
        </div>
        <div>
          <label for="popup-price">Price:</label><br>
          <input type="text" id="popup-price" name="popup-price"><br><br>
        </div>
        <div>
          <button type="submit">Save</button>
        </div>
      </form>
      <button onclick="hidePopUp()">Cancel</button>
    </div>
  </div>

  <footer class="footer-messages">
    <hr>
    Made by Gonçalo Bárias (103134), Raquel Braunschweig (102624) and Vasco Paisana (102533) @ IST
  </footer>

</body>

</html>
